(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :
  typeof define === 'function' && define.amd ? define(['exports'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory((global.dc = global.dc || {}, global.dc.azure_map = {})));
})(this, (function (exports) { 'use strict';

  // const processChange = debounce(fn);

  function getAfFieldId(afField) {
    return afField.jsonModel.id || afField.jsonModel.templateId;
  }

  function promise(cssSelector) {
    var visible = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    return new Promise(function (resolve) {
      var checking = setInterval(function () {
        $(cssSelector).length;

        if (visible && $(cssSelector).is(':visible') || !visible && $(cssSelector).length > 0) {
          clearInterval(checking);
          resolve(true);
        }
      }, 5);
    });
  }
  function yourLocation() {
    return new Promise(function (resolve, reject) {
      navigator.geolocation.getCurrentPosition(function (position) {
        var userPosition = {
          lng: position.coords.longitude,
          lat: position.coords.latitude
        };
        resolve(userPosition);
      }, function (error) {
        //If an error occurs when trying to access the users position information, display an error message.
        switch (error.code) {
          case error.PERMISSION_DENIED:
            alert('User denied the request for Geolocation.');
            break;

          case error.POSITION_UNAVAILABLE:
            alert('Position information is unavailable.');
            break;

          case error.TIMEOUT:
            alert('The request to get user position timed out.');
            break;

          case error.UNKNOWN_ERROR:
            alert('An unknown error occurred.');
            break;
        }

        reject(undefined);
      });
    });
  } //ex: getUrlParam('wcmmode')

  var atlasPromise = undefined; //Note that the typeahead parameter is set to true.

  var geocodeServiceUrlTemplate = 'https://{azMapsDomain}/search/{searchType}/json?typeahead=true&api-version=1&query={query}&language={language}&lon={lon}&lat={lat}&countrySet={countrySet}&view=Auto'; // promise load once for all invoker

  var loadAtlas = function loadAtlas() {
    if (atlasPromise) {
      return atlasPromise;
    } else {
      atlasPromise = new Promise(function (resolve) {
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.href = 'https://atlas.microsoft.com/sdk/javascript/mapcontrol/2/atlas.min.css';
        link.type = 'text/css';
        document.head.appendChild(link);
        link = document.createElement('link');
        link.rel = 'stylesheet';
        link.href = 'https://code.jquery.com/ui/1.13.0/themes/smoothness/jquery-ui.css';
        link.type = 'text/css';
        document.head.appendChild(link);
        var script = document.createElement('script');
        script.type = 'text/javascript';
        script.src = 'https://code.jquery.com/ui/1.13.0/jquery-ui.js';
        document.head.appendChild(script);
        script = document.createElement('script');
        script.type = 'text/javascript';

        script.onload = function () {
          atlas.setView('Auto');
          yourLocation().then(function (yourLoc) {
            resolve(yourLoc);
          });
        };

        script.onreadystatechange = function () {
          // for IE
          resolve({});
        };

        script.src = 'https://atlas.microsoft.com/sdk/javascript/mapcontrol/2/atlas.min.js';
        document.head.appendChild(script);
        var atService = document.createElement('script');
        atService.type = 'text/javascript';
        atService.src = 'https://atlas.microsoft.com/sdk/javascript/service/2/atlas-service.min.js';
        document.head.appendChild(atService);
      });
      return atlasPromise;
    }
  }; //used by afFld.initialize


  function init(thisInput) {
    var searchBoxId = getAfFieldId(thisInput);
    var parentPanel = thisInput.parent;
    loadAtlas().then(function (yourLoc) {
      // when textbox available, append mapDiv
      promise("#".concat(searchBoxId)).then(function () {
        var $div = $('<div>', {
          id: "".concat(searchBoxId, "_map"),
          "class": 'mapDiv'
        });
        $("#".concat(searchBoxId, " input")).after($div);
        var searchInputId = $("#".concat(searchBoxId, " input")).attr('id'); // when mapDiv available and visible

        promise("#".concat(searchBoxId, "_map"), true).then(function () {
          var divId = searchBoxId + '_map';
          var map = new atlas.Map(divId, {
            center: [-75.89929097426723, 45.31358572144141],
            zoom: 14,
            view: 'Auto',
            renderWorldCopies: false,
            autoResize: true,
            showLogo: false,
            showFeedbackLink: false,
            style: 'road',
            authOptions: {
              authType: 'subscriptionKey',
              subscriptionKey: '1L_SO0IYB4G2_lXaOkv40jEbUazPbywLfgdGgrgsX6Q'
            }
          });

          var processRequest = function processRequest(url) {
            //This is a reusable function that sets the Azure Maps platform domain, sign the request, and makes use of any transformRequest set on the map.
            return new Promise(function (resolve, reject) {
              //Replace the domain placeholder to ensure the same Azure Maps cloud is used throughout the app.
              url = url.replace('{azMapsDomain}', atlas.getDomain()); //Get the authentication details from the map for use in the request.

              var requestParams = map.authentication.signRequest({
                url: url
              }); //Transform the request.

              var transform = map.getServiceOptions().tranformRequest;

              if (transform) {
                requestParams = transform(url);
              }

              fetch(requestParams.url, {
                method: 'GET',
                mode: 'cors',
                headers: new Headers(requestParams.headers)
              }).then(function (r) {
                return r.json();
              }, function (e) {
                return reject(e);
              }).then(function (r) {
                resolve(r);
              }, function (e) {
                return reject(e);
              });
            });
          };

          map.events.add('ready', function () {
            var datasource = new atlas.source.DataSource();
            map.sources.add(datasource);
            map.setCamera({
              center: [yourLoc.lng, yourLoc.lat]
            }); //Add a layer for rendering point data.

            map.layers.add(new atlas.layer.SymbolLayer(datasource));

            $("#".concat(searchInputId)).autocomplete({
              minLength: 3,
              delay: 500,
              source: function source(request, response) {
                var center = map.getCamera().center;
                var countryIso = 'CA,US'; //Create a URL to the Azure Maps search service to perform the search.

                var requestUrl = geocodeServiceUrlTemplate.replace('{query}', encodeURIComponent(request.term)).replace('{searchType}', 'fuzzy').replace('{language}', 'en-US').replace('{lon}', center[0]).replace('{lat}', center[1]).replace('{countrySet}', countryIso); //A comma seperated string of country codes to limit the suggestions to.

                processRequest(requestUrl).then(function (data) {
                  response(data.results);
                });
              },
              select: function select(event, ui) {
                //Remove any previous added data from the map.
                datasource.clear(); //Create a point feature to mark the selected location.

                datasource.add(new atlas.data.Feature(new atlas.data.Point([ui.item.position.lon, ui.item.position.lat]), ui.item)); //Zoom the map into the selected location.

                map.setCamera({
                  bounds: [ui.item.viewport.topLeftPoint.lon, ui.item.viewport.btmRightPoint.lat, ui.item.viewport.btmRightPoint.lon, ui.item.viewport.topLeftPoint.lat],
                  padding: 30
                });
                console.log(ui.item);
                var mapping = new Map();
                mapping.set('postalCode', 'extendedPostalCode');
                mapping.set('addressline1', 'freeformAddress');
                mapping.set('city', 'municipality');
                mapping.set('landmark', 'localName');
                mapping.set('state', 'countrySubdivisionName');
                parentPanel.items.forEach(function (item) {
                  if (mapping.get(item.name)) {
                    var key = mapping.get(item.name);
                    item.value = ui.item.address[key];
                  }
                });
                event.preventDefault();
                thisInput.value = ui.item.address.freeformAddress;
                return true;
              }
            }).autocomplete('instance')._renderItem = function (ul, item) {
              var suggestionLabel = item.address.freeformAddress;

              if (item.poi && item.poi.name) {
                suggestionLabel = item.poi.name + ' (' + suggestionLabel + ')';
              }

              return $('<li>').append('<a>' + suggestionLabel + '</a>').appendTo(ul);
            };
          });
        });
      });
    });
  }

  exports.init = init;

}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9tYWluL2pzL2NvbW1vbi9nZW5lcmljLmpzIiwiLi4vLi4vLi4vc3JjL21haW4vanMvYXp1cmVfbWFwL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGNvbnN0IHByb2Nlc3NDaGFuZ2UgPSBkZWJvdW5jZShmbik7XG4vLyA8YnV0dG9uIG9uY2xpY2s9XCJwcm9jZXNzQ2hhbmdlKClcIj5DbGljayBtZTwvYnV0dG9uPlxuLy8gd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgcHJvY2Vzc0NoYW5nZSk7XG4vL2V4OiBsZXQgZm4xID0gZGVib3VuY2UoZm4pXG5leHBvcnQgZnVuY3Rpb24gZGVib3VuY2UoZnVuYywgY29udGV4dCwgdGltZW91dCA9IDMwMCkge1xuICBsZXQgdGltZXI7XG4gIHJldHVybiAoLi4uYXJncykgPT4ge1xuICAgIGNsZWFyVGltZW91dCh0aW1lcik7XG4gICAgdGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGZ1bmMuYXBwbHkoY29udGV4dCB8fCB0aGlzLCBhcmdzKTtcbiAgICB9LCB0aW1lb3V0KTtcbiAgfTtcbn1cblxuLy8gY2FsbCBpbW1lZGlhdGVseSwgYW5kIGlnbm9yZSBzdWJzZXF1ZW50XG4vL2V4OiBsZXQgZm4xPWRlYm91bmNlX2xlYWRpbmcoZm4pXG5leHBvcnQgZnVuY3Rpb24gZGVib3VuY2VfbGVhZGluZyhmdW5jLCBjb250ZXh0LCB0aW1lb3V0ID0gMzAwKSB7XG4gIGxldCB0aW1lcjtcbiAgcmV0dXJuICguLi5hcmdzKSA9PiB7XG4gICAgaWYgKCF0aW1lcikge1xuICAgICAgZnVuYy5hcHBseShjb250ZXh0IHx8IHRoaXMsIGFyZ3MpO1xuICAgIH1cbiAgICBjbGVhclRpbWVvdXQodGltZXIpO1xuICAgIHRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICB0aW1lciA9IHVuZGVmaW5lZDtcbiAgICB9LCB0aW1lb3V0KTtcbiAgfTtcbn1cblxuLy9leDogbGV0IGZuMSA9IGV4ZWNPbmNlKGxvYWRBdGxhcylcbmV4cG9ydCBmdW5jdGlvbiBleGVjT25jZShmdW5jLCBjb250ZXh0KSB7XG4gIHZhciByZXN1bHQ7XG4gIHJldHVybiAoLi4uYXJncykgPT4ge1xuICAgIGlmIChmdW5jKSB7XG4gICAgICByZXN1bHQgPSBmdW5jLmFwcGx5KGNvbnRleHQgfHwgdGhpcywgYXJncyk7XG4gICAgICBmdW5jID0gbnVsbDtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcbn1cblxuLy9leDogc2xlZXAoMjAwMCkudGhlbiggKCk9Pnt9ICk7XG5leHBvcnQgY29uc3Qgc2xlZXAgPSAobXMpID0+IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIG1zKSk7XG5cbi8vaWQgaXMgYXZhaWxhYmxlIGZvciByZXBlYXRhYmxlIGl0ZW1zXG5leHBvcnQgZnVuY3Rpb24gZ2V0QWZGaWVsZElkKGFmRmllbGQpIHtcbiAgcmV0dXJuIGFmRmllbGQuanNvbk1vZGVsLmlkIHx8IGFmRmllbGQuanNvbk1vZGVsLnRlbXBsYXRlSWQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZW5kZXJTdGF0aWNIdG1sKGZsZCwgaHRtbCkge1xuICBpZiAoJ2d1aWRlVGV4dERyYXcnID09PSBmbGQuY2xhc3NOYW1lKSB7XG4gICAgdmFyIGZsZElkID0gZ2V0QWZGaWVsZElkKGZsZCk7XG4gICAgJCgnIycgKyBmbGRJZCkuaHRtbChodG1sKTtcbiAgfVxufVxuXG4vL3Byb21pc2UoJyNpZGQxJykudGhlbiggKCk9e30gKTtcbmV4cG9ydCBmdW5jdGlvbiBwcm9taXNlKGNzc1NlbGVjdG9yLCB2aXNpYmxlID0gZmFsc2UpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgbGV0IGNoZWNraW5nID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgbGV0IHRvdGFsID0gJChjc3NTZWxlY3RvcikubGVuZ3RoO1xuICAgICAgaWYgKFxuICAgICAgICAodmlzaWJsZSAmJiAkKGNzc1NlbGVjdG9yKS5pcygnOnZpc2libGUnKSkgfHxcbiAgICAgICAgKCF2aXNpYmxlICYmICQoY3NzU2VsZWN0b3IpLmxlbmd0aCA+IDApXG4gICAgICApIHtcbiAgICAgICAgY2xlYXJJbnRlcnZhbChjaGVja2luZyk7XG4gICAgICAgIHJlc29sdmUodHJ1ZSk7XG4gICAgICB9XG4gICAgfSwgNSk7XG4gIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24geW91ckxvY2F0aW9uKCkge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIG5hdmlnYXRvci5nZW9sb2NhdGlvbi5nZXRDdXJyZW50UG9zaXRpb24oXG4gICAgICAocG9zaXRpb24pID0+IHtcbiAgICAgICAgbGV0IHVzZXJQb3NpdGlvbiA9IHtcbiAgICAgICAgICBsbmc6IHBvc2l0aW9uLmNvb3Jkcy5sb25naXR1ZGUsXG4gICAgICAgICAgbGF0OiBwb3NpdGlvbi5jb29yZHMubGF0aXR1ZGUsXG4gICAgICAgIH07XG4gICAgICAgIHJlc29sdmUodXNlclBvc2l0aW9uKTtcbiAgICAgIH0sXG4gICAgICAoZXJyb3IpID0+IHtcbiAgICAgICAgLy9JZiBhbiBlcnJvciBvY2N1cnMgd2hlbiB0cnlpbmcgdG8gYWNjZXNzIHRoZSB1c2VycyBwb3NpdGlvbiBpbmZvcm1hdGlvbiwgZGlzcGxheSBhbiBlcnJvciBtZXNzYWdlLlxuICAgICAgICBzd2l0Y2ggKGVycm9yLmNvZGUpIHtcbiAgICAgICAgICBjYXNlIGVycm9yLlBFUk1JU1NJT05fREVOSUVEOlxuICAgICAgICAgICAgYWxlcnQoJ1VzZXIgZGVuaWVkIHRoZSByZXF1ZXN0IGZvciBHZW9sb2NhdGlvbi4nKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgZXJyb3IuUE9TSVRJT05fVU5BVkFJTEFCTEU6XG4gICAgICAgICAgICBhbGVydCgnUG9zaXRpb24gaW5mb3JtYXRpb24gaXMgdW5hdmFpbGFibGUuJyk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIGVycm9yLlRJTUVPVVQ6XG4gICAgICAgICAgICBhbGVydCgnVGhlIHJlcXVlc3QgdG8gZ2V0IHVzZXIgcG9zaXRpb24gdGltZWQgb3V0LicpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSBlcnJvci5VTktOT1dOX0VSUk9SOlxuICAgICAgICAgICAgYWxlcnQoJ0FuIHVua25vd24gZXJyb3Igb2NjdXJyZWQuJyk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICByZWplY3QodW5kZWZpbmVkKTtcbiAgICAgIH1cbiAgICApO1xuICB9KTtcbn1cblxuLy9leDogZ2V0VXJsUGFyYW0oJ3djbW1vZGUnKVxuZXhwb3J0IGZ1bmN0aW9uIGdldFVybFBhcmFtKG5hbWUsIHVybCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmKSB7XG4gIHZhciByZXN1bHRzID0gbmV3IFJlZ0V4cCgnWz8mXScgKyBuYW1lLnRvTG93ZXJDYXNlKCkgKyAnPShbXiYjXSopJykuZXhlYyhcbiAgICB1cmwudG9Mb3dlckNhc2UoKVxuICApO1xuICBpZiAocmVzdWx0cyA9PSBudWxsKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGRlY29kZVVSSShyZXN1bHRzWzFdKSB8fCAwO1xuICB9XG59XG5cbi8vZ3VpZGVsaWIudXRpbC5HdWlkZVV0aWwubmF2aWdhdGVUb1VSTCgnL2NvbnRlbnQvZGFtL2Zvcm1zYW5kZG9jdW1lbnRzL2RjLXNhbmRib3gvdHR0L2pjcjpjb250ZW50P3djbW1vZGU9ZGlzYWJsZWQnLCdTQU1FX1RBQicpXG4vL2d1aWRlbGliLnV0aWwuR3VpZGVVdGlsLm5hdmlnYXRlVG9VUkwoJ2h0dHA6Ly93d3cuZ29vZ2xlLmNvbScsJ1NBTUVfVEFCJylcbmV4cG9ydCBmdW5jdGlvbiBuYXZpZ2F0ZVRvVVJMKHVybCkge1xuICBndWlkZWxpYi51dGlsLkd1aWRlVXRpbC5uYXZpZ2F0ZVRvVVJMKHVybCwgJ1NBTUVfVEFCJyk7XG59XG4iLCJpbXBvcnQgJy4vaW5kZXguY3NzJztcbmltcG9ydCB7IGdldEFmRmllbGRJZCwgcHJvbWlzZSwgeW91ckxvY2F0aW9uIH0gZnJvbSAnLi4vY29tbW9uL2dlbmVyaWMnO1xubGV0IGF0bGFzUHJvbWlzZSA9IHVuZGVmaW5lZDtcblxuLy9Ob3RlIHRoYXQgdGhlIHR5cGVhaGVhZCBwYXJhbWV0ZXIgaXMgc2V0IHRvIHRydWUuXG5sZXQgZ2VvY29kZVNlcnZpY2VVcmxUZW1wbGF0ZSA9XG4gICdodHRwczovL3thek1hcHNEb21haW59L3NlYXJjaC97c2VhcmNoVHlwZX0vanNvbj90eXBlYWhlYWQ9dHJ1ZSZhcGktdmVyc2lvbj0xJnF1ZXJ5PXtxdWVyeX0mbGFuZ3VhZ2U9e2xhbmd1YWdlfSZsb249e2xvbn0mbGF0PXtsYXR9JmNvdW50cnlTZXQ9e2NvdW50cnlTZXR9JnZpZXc9QXV0byc7XG5cbi8vIHByb21pc2UgbG9hZCBvbmNlIGZvciBhbGwgaW52b2tlclxuY29uc3QgbG9hZEF0bGFzID0gKCkgPT4ge1xuICBpZiAoYXRsYXNQcm9taXNlKSB7XG4gICAgcmV0dXJuIGF0bGFzUHJvbWlzZTtcbiAgfSBlbHNlIHtcbiAgICBhdGxhc1Byb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgICAgbGV0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaW5rJyk7XG4gICAgICBsaW5rLnJlbCA9ICdzdHlsZXNoZWV0JztcbiAgICAgIGxpbmsuaHJlZiA9XG4gICAgICAgICdodHRwczovL2F0bGFzLm1pY3Jvc29mdC5jb20vc2RrL2phdmFzY3JpcHQvbWFwY29udHJvbC8yL2F0bGFzLm1pbi5jc3MnO1xuICAgICAgbGluay50eXBlID0gJ3RleHQvY3NzJztcbiAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQobGluayk7XG5cbiAgICAgIGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaW5rJyk7XG4gICAgICBsaW5rLnJlbCA9ICdzdHlsZXNoZWV0JztcbiAgICAgIGxpbmsuaHJlZiA9XG4gICAgICAgICdodHRwczovL2NvZGUuanF1ZXJ5LmNvbS91aS8xLjEzLjAvdGhlbWVzL3Ntb290aG5lc3MvanF1ZXJ5LXVpLmNzcyc7XG4gICAgICBsaW5rLnR5cGUgPSAndGV4dC9jc3MnO1xuICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChsaW5rKTtcblxuICAgICAgbGV0IHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xuICAgICAgc2NyaXB0LnR5cGUgPSAndGV4dC9qYXZhc2NyaXB0JztcbiAgICAgIHNjcmlwdC5zcmMgPSAnaHR0cHM6Ly9jb2RlLmpxdWVyeS5jb20vdWkvMS4xMy4wL2pxdWVyeS11aS5qcyc7XG4gICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHNjcmlwdCk7XG5cbiAgICAgIHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xuICAgICAgc2NyaXB0LnR5cGUgPSAndGV4dC9qYXZhc2NyaXB0JztcbiAgICAgIHNjcmlwdC5vbmxvYWQgPSAoKSA9PiB7XG4gICAgICAgIGF0bGFzLnNldFZpZXcoJ0F1dG8nKTtcbiAgICAgICAgeW91ckxvY2F0aW9uKCkudGhlbigoeW91ckxvYykgPT4ge1xuICAgICAgICAgIHJlc29sdmUoeW91ckxvYyk7XG4gICAgICAgIH0pO1xuICAgICAgfTtcbiAgICAgIHNjcmlwdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSAoKSA9PiB7XG4gICAgICAgIC8vIGZvciBJRVxuICAgICAgICByZXNvbHZlKHt9KTtcbiAgICAgIH07XG4gICAgICBzY3JpcHQuc3JjID1cbiAgICAgICAgJ2h0dHBzOi8vYXRsYXMubWljcm9zb2Z0LmNvbS9zZGsvamF2YXNjcmlwdC9tYXBjb250cm9sLzIvYXRsYXMubWluLmpzJztcbiAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc2NyaXB0KTtcblxuICAgICAgbGV0IGF0U2VydmljZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xuICAgICAgYXRTZXJ2aWNlLnR5cGUgPSAndGV4dC9qYXZhc2NyaXB0JztcbiAgICAgIGF0U2VydmljZS5zcmMgPVxuICAgICAgICAnaHR0cHM6Ly9hdGxhcy5taWNyb3NvZnQuY29tL3Nkay9qYXZhc2NyaXB0L3NlcnZpY2UvMi9hdGxhcy1zZXJ2aWNlLm1pbi5qcyc7XG4gICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGF0U2VydmljZSk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gYXRsYXNQcm9taXNlO1xuICB9XG59O1xuXG4vL3VzZWQgYnkgYWZGbGQuaW5pdGlhbGl6ZVxuZXhwb3J0IGZ1bmN0aW9uIGluaXQodGhpc0lucHV0KSB7XG4gIGxldCBzZWFyY2hCb3hJZCA9IGdldEFmRmllbGRJZCh0aGlzSW5wdXQpO1xuICBsZXQgcGFyZW50UGFuZWwgPSB0aGlzSW5wdXQucGFyZW50O1xuXG4gIGxvYWRBdGxhcygpLnRoZW4oKHlvdXJMb2MpID0+IHtcbiAgICAvLyB3aGVuIHRleHRib3ggYXZhaWxhYmxlLCBhcHBlbmQgbWFwRGl2XG4gICAgcHJvbWlzZShgIyR7c2VhcmNoQm94SWR9YCkudGhlbigoKSA9PiB7XG4gICAgICBjb25zdCAkZGl2ID0gJCgnPGRpdj4nLCB7XG4gICAgICAgIGlkOiBgJHtzZWFyY2hCb3hJZH1fbWFwYCxcbiAgICAgICAgY2xhc3M6ICdtYXBEaXYnLFxuICAgICAgfSk7XG4gICAgICAkKGAjJHtzZWFyY2hCb3hJZH0gaW5wdXRgKS5hZnRlcigkZGl2KTtcbiAgICAgIGxldCBzZWFyY2hJbnB1dElkID0gJChgIyR7c2VhcmNoQm94SWR9IGlucHV0YCkuYXR0cignaWQnKTtcblxuICAgICAgLy8gd2hlbiBtYXBEaXYgYXZhaWxhYmxlIGFuZCB2aXNpYmxlXG4gICAgICBwcm9taXNlKGAjJHtzZWFyY2hCb3hJZH1fbWFwYCwgdHJ1ZSkudGhlbigoKSA9PiB7XG4gICAgICAgIGxldCBkaXZJZCA9IHNlYXJjaEJveElkICsgJ19tYXAnO1xuICAgICAgICBsZXQgbWFwID0gbmV3IGF0bGFzLk1hcChkaXZJZCwge1xuICAgICAgICAgIGNlbnRlcjogWy03NS44OTkyOTA5NzQyNjcyMywgNDUuMzEzNTg1NzIxNDQxNDFdLFxuICAgICAgICAgIHpvb206IDE0LFxuICAgICAgICAgIHZpZXc6ICdBdXRvJyxcbiAgICAgICAgICByZW5kZXJXb3JsZENvcGllczogZmFsc2UsXG4gICAgICAgICAgYXV0b1Jlc2l6ZTogdHJ1ZSxcbiAgICAgICAgICBzaG93TG9nbzogZmFsc2UsXG4gICAgICAgICAgc2hvd0ZlZWRiYWNrTGluazogZmFsc2UsXG4gICAgICAgICAgc3R5bGU6ICdyb2FkJyxcblxuICAgICAgICAgIGF1dGhPcHRpb25zOiB7XG4gICAgICAgICAgICBhdXRoVHlwZTogJ3N1YnNjcmlwdGlvbktleScsXG4gICAgICAgICAgICBzdWJzY3JpcHRpb25LZXk6ICcxTF9TTzBJWUI0RzJfbFhhT2t2NDBqRWJVYXpQYnl3TGZnZEdncmdzWDZRJyxcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBwcm9jZXNzUmVxdWVzdCA9ICh1cmwpID0+IHtcbiAgICAgICAgICAvL1RoaXMgaXMgYSByZXVzYWJsZSBmdW5jdGlvbiB0aGF0IHNldHMgdGhlIEF6dXJlIE1hcHMgcGxhdGZvcm0gZG9tYWluLCBzaWduIHRoZSByZXF1ZXN0LCBhbmQgbWFrZXMgdXNlIG9mIGFueSB0cmFuc2Zvcm1SZXF1ZXN0IHNldCBvbiB0aGUgbWFwLlxuICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICAvL1JlcGxhY2UgdGhlIGRvbWFpbiBwbGFjZWhvbGRlciB0byBlbnN1cmUgdGhlIHNhbWUgQXp1cmUgTWFwcyBjbG91ZCBpcyB1c2VkIHRocm91Z2hvdXQgdGhlIGFwcC5cbiAgICAgICAgICAgIHVybCA9IHVybC5yZXBsYWNlKCd7YXpNYXBzRG9tYWlufScsIGF0bGFzLmdldERvbWFpbigpKTtcblxuICAgICAgICAgICAgLy9HZXQgdGhlIGF1dGhlbnRpY2F0aW9uIGRldGFpbHMgZnJvbSB0aGUgbWFwIGZvciB1c2UgaW4gdGhlIHJlcXVlc3QuXG4gICAgICAgICAgICBsZXQgcmVxdWVzdFBhcmFtcyA9IG1hcC5hdXRoZW50aWNhdGlvbi5zaWduUmVxdWVzdCh7IHVybDogdXJsIH0pO1xuXG4gICAgICAgICAgICAvL1RyYW5zZm9ybSB0aGUgcmVxdWVzdC5cbiAgICAgICAgICAgIGxldCB0cmFuc2Zvcm0gPSBtYXAuZ2V0U2VydmljZU9wdGlvbnMoKS50cmFuZm9ybVJlcXVlc3Q7XG4gICAgICAgICAgICBpZiAodHJhbnNmb3JtKSB7XG4gICAgICAgICAgICAgIHJlcXVlc3RQYXJhbXMgPSB0cmFuc2Zvcm0odXJsKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZmV0Y2gocmVxdWVzdFBhcmFtcy51cmwsIHtcbiAgICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgICAgbW9kZTogJ2NvcnMnLFxuICAgICAgICAgICAgICBoZWFkZXJzOiBuZXcgSGVhZGVycyhyZXF1ZXN0UGFyYW1zLmhlYWRlcnMpLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgLnRoZW4oXG4gICAgICAgICAgICAgICAgKHIpID0+IHIuanNvbigpLFxuICAgICAgICAgICAgICAgIChlKSA9PiByZWplY3QoZSlcbiAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAudGhlbihcbiAgICAgICAgICAgICAgICAocikgPT4ge1xuICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIChlKSA9PiByZWplY3QoZSlcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICBtYXAuZXZlbnRzLmFkZCgncmVhZHknLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgbGV0IGRhdGFzb3VyY2UgPSBuZXcgYXRsYXMuc291cmNlLkRhdGFTb3VyY2UoKTtcbiAgICAgICAgICBtYXAuc291cmNlcy5hZGQoZGF0YXNvdXJjZSk7XG4gICAgICAgICAgbWFwLnNldENhbWVyYSh7XG4gICAgICAgICAgICBjZW50ZXI6IFt5b3VyTG9jLmxuZywgeW91ckxvYy5sYXRdLFxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgLy9BZGQgYSBsYXllciBmb3IgcmVuZGVyaW5nIHBvaW50IGRhdGEuXG4gICAgICAgICAgbWFwLmxheWVycy5hZGQobmV3IGF0bGFzLmxheWVyLlN5bWJvbExheWVyKGRhdGFzb3VyY2UpKTtcblxuICAgICAgICAgICQoYCMke3NlYXJjaElucHV0SWR9YClcbiAgICAgICAgICAgIC5hdXRvY29tcGxldGUoe1xuICAgICAgICAgICAgICBtaW5MZW5ndGg6IDMsXG4gICAgICAgICAgICAgIGRlbGF5OiA1MDAsXG4gICAgICAgICAgICAgIHNvdXJjZTogKHJlcXVlc3QsIHJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IGNlbnRlciA9IG1hcC5nZXRDYW1lcmEoKS5jZW50ZXI7XG5cbiAgICAgICAgICAgICAgICBsZXQgY291bnRyeUlzbyA9ICdDQSxVUyc7XG5cbiAgICAgICAgICAgICAgICAvL0NyZWF0ZSBhIFVSTCB0byB0aGUgQXp1cmUgTWFwcyBzZWFyY2ggc2VydmljZSB0byBwZXJmb3JtIHRoZSBzZWFyY2guXG4gICAgICAgICAgICAgICAgbGV0IHJlcXVlc3RVcmwgPSBnZW9jb2RlU2VydmljZVVybFRlbXBsYXRlXG4gICAgICAgICAgICAgICAgICAucmVwbGFjZSgne3F1ZXJ5fScsIGVuY29kZVVSSUNvbXBvbmVudChyZXF1ZXN0LnRlcm0pKVxuICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoJ3tzZWFyY2hUeXBlfScsICdmdXp6eScpXG4gICAgICAgICAgICAgICAgICAucmVwbGFjZSgne2xhbmd1YWdlfScsICdlbi1VUycpXG4gICAgICAgICAgICAgICAgICAucmVwbGFjZSgne2xvbn0nLCBjZW50ZXJbMF0pXG4gICAgICAgICAgICAgICAgICAucmVwbGFjZSgne2xhdH0nLCBjZW50ZXJbMV0pXG4gICAgICAgICAgICAgICAgICAucmVwbGFjZSgne2NvdW50cnlTZXR9JywgY291bnRyeUlzbyk7IC8vQSBjb21tYSBzZXBlcmF0ZWQgc3RyaW5nIG9mIGNvdW50cnkgY29kZXMgdG8gbGltaXQgdGhlIHN1Z2dlc3Rpb25zIHRvLlxuXG4gICAgICAgICAgICAgICAgcHJvY2Vzc1JlcXVlc3QocmVxdWVzdFVybCkudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICAgICAgICAgICAgcmVzcG9uc2UoZGF0YS5yZXN1bHRzKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2VsZWN0OiAoZXZlbnQsIHVpKSA9PiB7XG4gICAgICAgICAgICAgICAgLy9SZW1vdmUgYW55IHByZXZpb3VzIGFkZGVkIGRhdGEgZnJvbSB0aGUgbWFwLlxuICAgICAgICAgICAgICAgIGRhdGFzb3VyY2UuY2xlYXIoKTtcblxuICAgICAgICAgICAgICAgIC8vQ3JlYXRlIGEgcG9pbnQgZmVhdHVyZSB0byBtYXJrIHRoZSBzZWxlY3RlZCBsb2NhdGlvbi5cbiAgICAgICAgICAgICAgICBkYXRhc291cmNlLmFkZChcbiAgICAgICAgICAgICAgICAgIG5ldyBhdGxhcy5kYXRhLkZlYXR1cmUoXG4gICAgICAgICAgICAgICAgICAgIG5ldyBhdGxhcy5kYXRhLlBvaW50KFtcbiAgICAgICAgICAgICAgICAgICAgICB1aS5pdGVtLnBvc2l0aW9uLmxvbixcbiAgICAgICAgICAgICAgICAgICAgICB1aS5pdGVtLnBvc2l0aW9uLmxhdCxcbiAgICAgICAgICAgICAgICAgICAgXSksXG4gICAgICAgICAgICAgICAgICAgIHVpLml0ZW1cbiAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgLy9ab29tIHRoZSBtYXAgaW50byB0aGUgc2VsZWN0ZWQgbG9jYXRpb24uXG4gICAgICAgICAgICAgICAgbWFwLnNldENhbWVyYSh7XG4gICAgICAgICAgICAgICAgICBib3VuZHM6IFtcbiAgICAgICAgICAgICAgICAgICAgdWkuaXRlbS52aWV3cG9ydC50b3BMZWZ0UG9pbnQubG9uLFxuICAgICAgICAgICAgICAgICAgICB1aS5pdGVtLnZpZXdwb3J0LmJ0bVJpZ2h0UG9pbnQubGF0LFxuICAgICAgICAgICAgICAgICAgICB1aS5pdGVtLnZpZXdwb3J0LmJ0bVJpZ2h0UG9pbnQubG9uLFxuICAgICAgICAgICAgICAgICAgICB1aS5pdGVtLnZpZXdwb3J0LnRvcExlZnRQb2ludC5sYXQsXG4gICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgcGFkZGluZzogMzAsXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh1aS5pdGVtKTtcbiAgICAgICAgICAgICAgICBsZXQgbWFwcGluZyA9IG5ldyBNYXAoKTtcbiAgICAgICAgICAgICAgICBtYXBwaW5nLnNldCgncG9zdGFsQ29kZScsICdleHRlbmRlZFBvc3RhbENvZGUnKTtcbiAgICAgICAgICAgICAgICBtYXBwaW5nLnNldCgnYWRkcmVzc2xpbmUxJywgJ2ZyZWVmb3JtQWRkcmVzcycpO1xuICAgICAgICAgICAgICAgIG1hcHBpbmcuc2V0KCdjaXR5JywgJ211bmljaXBhbGl0eScpO1xuICAgICAgICAgICAgICAgIG1hcHBpbmcuc2V0KCdsYW5kbWFyaycsICdsb2NhbE5hbWUnKTtcbiAgICAgICAgICAgICAgICBtYXBwaW5nLnNldCgnc3RhdGUnLCAnY291bnRyeVN1YmRpdmlzaW9uTmFtZScpO1xuICAgICAgICAgICAgICAgIHBhcmVudFBhbmVsLml0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgIGlmIChtYXBwaW5nLmdldChpdGVtLm5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBrZXkgPSBtYXBwaW5nLmdldChpdGVtLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnZhbHVlID0gdWkuaXRlbS5hZGRyZXNzW2tleV07XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB0aGlzSW5wdXQudmFsdWUgPSB1aS5pdGVtLmFkZHJlc3MuZnJlZWZvcm1BZGRyZXNzO1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5hdXRvY29tcGxldGUoJ2luc3RhbmNlJykuX3JlbmRlckl0ZW0gPSAodWwsIGl0ZW0pID0+IHtcbiAgICAgICAgICAgIGxldCBzdWdnZXN0aW9uTGFiZWwgPSBpdGVtLmFkZHJlc3MuZnJlZWZvcm1BZGRyZXNzO1xuXG4gICAgICAgICAgICBpZiAoaXRlbS5wb2kgJiYgaXRlbS5wb2kubmFtZSkge1xuICAgICAgICAgICAgICBzdWdnZXN0aW9uTGFiZWwgPSBpdGVtLnBvaS5uYW1lICsgJyAoJyArIHN1Z2dlc3Rpb25MYWJlbCArICcpJztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuICQoJzxsaT4nKVxuICAgICAgICAgICAgICAuYXBwZW5kKCc8YT4nICsgc3VnZ2VzdGlvbkxhYmVsICsgJzwvYT4nKVxuICAgICAgICAgICAgICAuYXBwZW5kVG8odWwpO1xuICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xufVxuIl0sIm5hbWVzIjpbImdldEFmRmllbGRJZCIsImFmRmllbGQiLCJqc29uTW9kZWwiLCJpZCIsInRlbXBsYXRlSWQiLCJwcm9taXNlIiwiY3NzU2VsZWN0b3IiLCJ2aXNpYmxlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJjaGVja2luZyIsInNldEludGVydmFsIiwiJCIsImxlbmd0aCIsImlzIiwiY2xlYXJJbnRlcnZhbCIsInlvdXJMb2NhdGlvbiIsInJlamVjdCIsIm5hdmlnYXRvciIsImdlb2xvY2F0aW9uIiwiZ2V0Q3VycmVudFBvc2l0aW9uIiwicG9zaXRpb24iLCJ1c2VyUG9zaXRpb24iLCJsbmciLCJjb29yZHMiLCJsb25naXR1ZGUiLCJsYXQiLCJsYXRpdHVkZSIsImVycm9yIiwiY29kZSIsIlBFUk1JU1NJT05fREVOSUVEIiwiYWxlcnQiLCJQT1NJVElPTl9VTkFWQUlMQUJMRSIsIlRJTUVPVVQiLCJVTktOT1dOX0VSUk9SIiwidW5kZWZpbmVkIiwiYXRsYXNQcm9taXNlIiwiZ2VvY29kZVNlcnZpY2VVcmxUZW1wbGF0ZSIsImxvYWRBdGxhcyIsImxpbmsiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJyZWwiLCJocmVmIiwidHlwZSIsImhlYWQiLCJhcHBlbmRDaGlsZCIsInNjcmlwdCIsInNyYyIsIm9ubG9hZCIsImF0bGFzIiwic2V0VmlldyIsInRoZW4iLCJ5b3VyTG9jIiwib25yZWFkeXN0YXRlY2hhbmdlIiwiYXRTZXJ2aWNlIiwiaW5pdCIsInRoaXNJbnB1dCIsInNlYXJjaEJveElkIiwicGFyZW50UGFuZWwiLCJwYXJlbnQiLCIkZGl2IiwiYWZ0ZXIiLCJzZWFyY2hJbnB1dElkIiwiYXR0ciIsImRpdklkIiwibWFwIiwiTWFwIiwiY2VudGVyIiwiem9vbSIsInZpZXciLCJyZW5kZXJXb3JsZENvcGllcyIsImF1dG9SZXNpemUiLCJzaG93TG9nbyIsInNob3dGZWVkYmFja0xpbmsiLCJzdHlsZSIsImF1dGhPcHRpb25zIiwiYXV0aFR5cGUiLCJzdWJzY3JpcHRpb25LZXkiLCJwcm9jZXNzUmVxdWVzdCIsInVybCIsInJlcGxhY2UiLCJnZXREb21haW4iLCJyZXF1ZXN0UGFyYW1zIiwiYXV0aGVudGljYXRpb24iLCJzaWduUmVxdWVzdCIsInRyYW5zZm9ybSIsImdldFNlcnZpY2VPcHRpb25zIiwidHJhbmZvcm1SZXF1ZXN0IiwiZmV0Y2giLCJtZXRob2QiLCJtb2RlIiwiaGVhZGVycyIsIkhlYWRlcnMiLCJyIiwianNvbiIsImUiLCJldmVudHMiLCJhZGQiLCJkYXRhc291cmNlIiwic291cmNlIiwiRGF0YVNvdXJjZSIsInNvdXJjZXMiLCJzZXRDYW1lcmEiLCJsYXllcnMiLCJsYXllciIsIlN5bWJvbExheWVyIiwiYXV0b2NvbXBsZXRlIiwibWluTGVuZ3RoIiwiZGVsYXkiLCJyZXF1ZXN0IiwicmVzcG9uc2UiLCJnZXRDYW1lcmEiLCJjb3VudHJ5SXNvIiwicmVxdWVzdFVybCIsImVuY29kZVVSSUNvbXBvbmVudCIsInRlcm0iLCJkYXRhIiwicmVzdWx0cyIsInNlbGVjdCIsImV2ZW50IiwidWkiLCJjbGVhciIsIkZlYXR1cmUiLCJQb2ludCIsIml0ZW0iLCJsb24iLCJib3VuZHMiLCJ2aWV3cG9ydCIsInRvcExlZnRQb2ludCIsImJ0bVJpZ2h0UG9pbnQiLCJwYWRkaW5nIiwiY29uc29sZSIsImxvZyIsIm1hcHBpbmciLCJzZXQiLCJpdGVtcyIsImZvckVhY2giLCJnZXQiLCJuYW1lIiwia2V5IiwidmFsdWUiLCJhZGRyZXNzIiwicHJldmVudERlZmF1bHQiLCJmcmVlZm9ybUFkZHJlc3MiLCJfcmVuZGVySXRlbSIsInVsIiwic3VnZ2VzdGlvbkxhYmVsIiwicG9pIiwiYXBwZW5kIiwiYXBwZW5kVG8iXSwibWFwcGluZ3MiOiI7Ozs7OztFQUFBOztFQTZDTyxTQUFTQSxZQUFULENBQXNCQyxPQUF0QixFQUErQjtFQUNwQyxTQUFPQSxPQUFPLENBQUNDLFNBQVIsQ0FBa0JDLEVBQWxCLElBQXdCRixPQUFPLENBQUNDLFNBQVIsQ0FBa0JFLFVBQWpEO0VBQ0Q7O0VBVU0sU0FBU0MsT0FBVCxDQUFpQkMsV0FBakIsRUFBK0M7RUFBQSxN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
